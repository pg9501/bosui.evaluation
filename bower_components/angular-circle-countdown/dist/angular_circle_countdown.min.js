angular.module("circle.countdown",[]).directive("countdown",["$timeout","$interval",function(n,o){return{scope:{time:"=time",date:"=date",finishCallback:"&callback"},restrict:"EA",template:'<div class="ClassyCountdown-wrapper"><div class="ClassyCountdown-days"><input value="{{ knob.seconds.value }}"/><span class="ClassyCountdown-value"><div></div><span></span></span></div><div class="ClassyCountdown-hours"><input value="{{ knob.seconds.value }}"/><span class="ClassyCountdown-value"><div></div><span></span></span></div><div class="ClassyCountdown-minutes"><input value="{{ knob.seconds.value }}"/><span class="ClassyCountdown-value"><div></div><span></span></span></div><div class="ClassyCountdown-seconds"><input value="{{ knob.seconds.value }}"/><span class="ClassyCountdown-value"><div></div><span></span></span></div></div>',replace:!1,controller:["$scope","$element","$attrs","$transclude",function(n,t,s,e){function a(){l.find(".ClassyCountdown-wrapper > div").each(function(){$(this).css("height",$(this).width()+"px")}),settings.style.textResponsive&&l.find(".ClassyCountdown-value").css("font-size",Math.floor(l.find("> div").eq(0).width()*settings.style.textResponsive/10)+"px"),l.find(".ClassyCountdown-value").each(function(){$(this).css("margin-top",Math.floor(0-parseInt($(this).height())/2)+"px")}),l.find(".ClassyCountdown-days input").trigger("change"),l.find(".ClassyCountdown-hours input").trigger("change"),l.find(".ClassyCountdown-minutes input").trigger("change"),l.find(".ClassyCountdown-seconds input").trigger("change"),l.find(".ClassyCountdown-days input").knob({width:$(".ClassyCountdown-days").width()}),l.find(".ClassyCountdown-hours input").knob({width:$(".ClassyCountdown-hours").width()}),l.find(".ClassyCountdown-minutes input").knob({width:$(".ClassyCountdown-minutes").width()}),l.find(".ClassyCountdown-seconds input").knob({width:$(".ClassyCountdown-seconds").width()}),$(".ClassyCountdown-days input").trigger("configure",{width:$(".ClassyCountdown-days").width()}),$(".ClassyCountdown-hours input").trigger("configure",{width:$(".ClassyCountdown-hours").width()}),$(".ClassyCountdown-minutes input").trigger("configure",{width:$(".ClassyCountdown-minutes").width()}),$(".ClassyCountdown-seconds input").trigger("configure",{width:$(".ClassyCountdown-seconds").width()})}var l=$(t)
s.autostart
n.knob={days:{value:60,options:{max:365,readOnly:!0,displayPrevious:!0}},hours:{value:60,options:{max:24,readOnly:!0,displayPrevious:!0}},minutes:{value:60,options:{max:60,readOnly:!0,displayPrevious:!0}},seconds:{value:60,options:{max:60,readOnly:!0,displayPrevious:!0}}},n.theme=s.colors||"white"
var i=function(n){switch(n){case"flat-colors":return{labels:!0,style:{element:"",textResponsive:.5,days:{gauge:{thickness:.01,bgColor:"rgba(0,0,0,0.05)",fgColor:"#1abc9c"},textCSS:'font-family:"Open Sans";font-weight:300;color:#34495e;'},hours:{gauge:{thickness:.01,bgColor:"rgba(0,0,0,0.05)",fgColor:"#2980b9"},textCSS:'font-family:"Open Sans";font-weight:300;color:#34495e;'},minutes:{gauge:{thickness:.01,bgColor:"rgba(0,0,0,0.05)",fgColor:"#8e44ad"},textCSS:'font-family:"Open Sans";font-weight:300;color:#34495e;'},seconds:{gauge:{thickness:.01,bgColor:"rgba(0,0,0,0.05)",fgColor:"#f39c12"},textCSS:'font-family:"Open Sans";font-weight:300;color:#34495e;'}}}
case"flat-colors-wide":return{labels:!0,style:{element:"",textResponsive:.5,days:{gauge:{thickness:.03,bgColor:"rgba(0,0,0,0.05)",fgColor:"#1abc9c"},textCSS:'font-family:"Open Sans";font-weight:300;color:#34495e;'},hours:{gauge:{thickness:.03,bgColor:"rgba(0,0,0,0.05)",fgColor:"#2980b9"},textCSS:'font-family:"Open Sans";font-weight:300;color:#34495e;'},minutes:{gauge:{thickness:.03,bgColor:"rgba(0,0,0,0.05)",fgColor:"#8e44ad"},textCSS:'font-family:"Open Sans";font-weight:300;color:#34495e;'},seconds:{gauge:{thickness:.03,bgColor:"rgba(0,0,0,0.05)",fgColor:"#f39c12"},textCSS:'font-family:"Open Sans";font-weight:300;color:#34495e;'}}}
case"flat-colors-very-wide":return{labels:!0,style:{element:"",textResponsive:.5,days:{gauge:{thickness:.12,bgColor:"rgba(0,0,0,0.05)",fgColor:"#1abc9c"},textCSS:'font-family:"Open Sans";font-weight:300;color:#34495e;'},hours:{gauge:{thickness:.12,bgColor:"rgba(0,0,0,0.05)",fgColor:"#2980b9"},textCSS:'font-family:"Open Sans";font-weight:300;color:#34495e;'},minutes:{gauge:{thickness:.12,bgColor:"rgba(0,0,0,0.05)",fgColor:"#8e44ad"},textCSS:'font-family:"Open Sans";font-weight:300;color:#34495e;'},seconds:{gauge:{thickness:.12,bgColor:"rgba(0,0,0,0.05)",fgColor:"#f39c12"},textCSS:'font-family:"Open Sans";font-weight:300;color:#34495e;'}}}
case"flat-colors-black":return{labels:!0,style:{element:"",textResponsive:.5,days:{gauge:{thickness:.25,bgColor:"rgba(0,0,0,0.05)",fgColor:"#1abc9c",lineCap:"round"},textCSS:'font-family:"Open Sans";font-weight:300;color:#34495e;'},hours:{gauge:{thickness:.25,bgColor:"rgba(0,0,0,0.05)",fgColor:"#2980b9",lineCap:"round"},textCSS:'font-family:"Open Sans";font-weight:300;color:#34495e;'},minutes:{gauge:{thickness:.25,bgColor:"rgba(0,0,0,0.05)",fgColor:"#8e44ad",lineCap:"round"},textCSS:'font-family:"Open Sans";font-weight:300;color:#34495e;'},seconds:{gauge:{thickness:.25,bgColor:"rgba(0,0,0,0.05)",fgColor:"#f39c12",lineCap:"round"},textCSS:'font-family:"Open Sans";font-weight:300;color:#34495e;'}}}
case"black":return{labels:!0,style:{element:"",textResponsive:.5,days:{gauge:{thickness:.01,bgColor:"rgba(0,0,0,0.05)",fgColor:"#222"},textCSS:'font-family:"Open Sans";font-weight:300;color:#34495e;'},hours:{gauge:{thickness:.01,bgColor:"rgba(0,0,0,0.05)",fgColor:"#222"},textCSS:'font-family:"Open Sans";font-weight:300;color:#34495e;'},minutes:{gauge:{thickness:.01,bgColor:"rgba(0,0,0,0.05)",fgColor:"#222"},textCSS:'font-family:"Open Sans";font-weight:300;color:#34495e;'},seconds:{gauge:{thickness:.01,bgColor:"rgba(0,0,0,0.05)",fgColor:"#222"},textCSS:'font-family:"Open Sans";font-weight:300;color:#34495e;'}}}
case"black-wide":return{labels:!0,style:{element:"",textResponsive:.5,days:{gauge:{thickness:.03,bgColor:"rgba(0,0,0,0.05)",fgColor:"#222"},textCSS:'font-family:"Open Sans";font-weight:300;color:#34495e;'},hours:{gauge:{thickness:.03,bgColor:"rgba(0,0,0,0.05)",fgColor:"#222"},textCSS:'font-family:"Open Sans";font-weight:300;color:#34495e;'},minutes:{gauge:{thickness:.03,bgColor:"rgba(0,0,0,0.05)",fgColor:"#222"},textCSS:'font-family:"Open Sans";font-weight:300;color:#34495e;'},seconds:{gauge:{thickness:.03,bgColor:"rgba(0,0,0,0.05)",fgColor:"#222"},textCSS:'font-family:"Open Sans";font-weight:300;color:#34495e;'}}}
case"black-very-wide":return{labels:!0,style:{element:"",textResponsive:.5,days:{gauge:{thickness:.17,bgColor:"rgba(0,0,0,0.05)",fgColor:"#222"},textCSS:'font-family:"Open Sans";font-weight:300;color:#34495e;'},hours:{gauge:{thickness:.17,bgColor:"rgba(0,0,0,0.05)",fgColor:"#222"},textCSS:'font-family:"Open Sans";font-weight:300;color:#34495e;'},minutes:{gauge:{thickness:.17,bgColor:"rgba(0,0,0,0.05)",fgColor:"#222"},textCSS:'font-family:"Open Sans";font-weight:300;color:#34495e;'},seconds:{gauge:{thickness:.17,bgColor:"rgba(0,0,0,0.05)",fgColor:"#222"},textCSS:'font-family:"Open Sans";font-weight:300;color:#34495e;'}}}
case"black-black":return{labels:!0,style:{element:"",textResponsive:.5,days:{gauge:{thickness:.25,bgColor:"rgba(0,0,0,0.05)",fgColor:"#222",lineCap:"round"},textCSS:'font-family:"Open Sans";font-weight:300;color:#34495e;'},hours:{gauge:{thickness:.25,bgColor:"rgba(0,0,0,0.05)",fgColor:"#222",lineCap:"round"},textCSS:'font-family:"Open Sans";font-weight:300;color:#34495e;'},minutes:{gauge:{thickness:.25,bgColor:"rgba(0,0,0,0.05)",fgColor:"#222",lineCap:"round"},textCSS:'font-family:"Open Sans";font-weight:300;color:#34495e;'},seconds:{gauge:{thickness:.25,bgColor:"rgba(0,0,0,0.05)",fgColor:"#222",lineCap:"round"},textCSS:'font-family:"Open Sans";font-weight:300;color:#34495e;'}}}
case"white":return{labels:!0,style:{element:"",textResponsive:.5,days:{gauge:{thickness:.03,bgColor:"rgba(255,255,255,0.05)",fgColor:"#fff"},textCSS:'font-family:"Open Sans";font-weight:300;color:#fff;'},hours:{gauge:{thickness:.03,bgColor:"rgba(255,255,255,0.05)",fgColor:"#fff"},textCSS:'font-family:"Open Sans";font-weight:300;color:#fff;'},minutes:{gauge:{thickness:.03,bgColor:"rgba(255,255,255,0.05)",fgColor:"#fff"},textCSS:'font-family:"Open Sans";font-weight:300;color:#fff;'},seconds:{gauge:{thickness:.03,bgColor:"rgba(255,255,255,0.05)",fgColor:"#fff"},textCSS:'font-family:"Open Sans";font-weight:300;color:#fff;'}}}
case"white-wide":return{labels:!0,style:{element:"",textResponsive:.5,days:{gauge:{thickness:.06,bgColor:"rgba(255,255,255,0.05)",fgColor:"#fff"},textCSS:'font-family:"Open Sans";font-weight:300;color:#fff;'},hours:{gauge:{thickness:.06,bgColor:"rgba(255,255,255,0.05)",fgColor:"#fff"},textCSS:'font-family:"Open Sans";font-weight:300;color:#fff;'},minutes:{gauge:{thickness:.06,bgColor:"rgba(255,255,255,0.05)",fgColor:"#fff"},textCSS:'font-family:"Open Sans";font-weight:300;color:#fff;'},seconds:{gauge:{thickness:.06,bgColor:"rgba(255,255,255,0.05)",fgColor:"#fff"},textCSS:'font-family:"Open Sans";font-weight:300;color:#fff;'}}}
case"white-very-wide":return{labels:!0,style:{element:"",textResponsive:.5,days:{gauge:{thickness:.16,bgColor:"rgba(255,255,255,0.05)",fgColor:"#fff"},textCSS:'font-family:"Open Sans";font-weight:300;color:#fff;'},hours:{gauge:{thickness:.16,bgColor:"rgba(255,255,255,0.05)",fgColor:"#fff"},textCSS:'font-family:"Open Sans";font-weight:300;color:#fff;'},minutes:{gauge:{thickness:.16,bgColor:"rgba(255,255,255,0.05)",fgColor:"#fff"},textCSS:'font-family:"Open Sans";font-weight:300;color:#fff;'},seconds:{gauge:{thickness:.16,bgColor:"rgba(255,255,255,0.05)",fgColor:"#fff"},textCSS:'font-family:"Open Sans";font-weight:300;color:#fff;'}}}
case"white-black":return{labels:!0,style:{element:"",textResponsive:.5,days:{gauge:{thickness:.25,bgColor:"rgba(255,255,255,0.05)",fgColor:"#fff",lineCap:"round"},textCSS:'font-family:"Open Sans";font-weight:300;color:#fff;'},hours:{gauge:{thickness:.25,bgColor:"rgba(255,255,255,0.05)",fgColor:"#fff",lineCap:"round"},textCSS:'font-family:"Open Sans";font-weight:300;color:#fff;'},minutes:{gauge:{thickness:.25,bgColor:"rgba(255,255,255,0.05)",fgColor:"#fff",lineCap:"round"},textCSS:'font-family:"Open Sans";font-weight:300;color:#fff;'},seconds:{gauge:{thickness:.25,bgColor:"rgba(255,255,255,0.05)",fgColor:"#fff",lineCap:"round"},textCSS:'font-family:"Open Sans";font-weight:300;color:#fff;'}}}}}(n.theme),f={end:void 0,now:$.now(),labels:!0,labelsOptions:{lang:{days:"Days",hours:"Hours",minutes:"Minutes",seconds:"Seconds"},style:"font-size: 0.5em;"},style:{element:"",labels:!1,textResponsive:.5,days:{gauge:{thickness:.02,bgColor:"rgba(0, 0, 0, 0)",fgColor:"rgba(0, 0, 0, 1)",lineCap:"butt"},textCSS:""},hours:{gauge:{thickness:.02,bgColor:"rgba(0, 0, 0, 0)",fgColor:"rgba(0, 0, 0, 1)",lineCap:"butt"},textCSS:""},minutes:{gauge:{thickness:.02,bgColor:"rgba(0, 0, 0, 0)",fgColor:"rgba(0, 0, 0, 1)",lineCap:"butt"},textCSS:""},seconds:{gauge:{thickness:.02,bgColor:"rgba(0, 0, 0, 0)",fgColor:"rgba(0, 0, 0, 1)",lineCap:"butt"},textCSS:""}},onEndCallback:function(){}}
settings=f,angular.extend(settings,i),angular.extend(n.knob.days.options,i.style.days.gauge),angular.extend(n.knob.hours.options,i.style.hours.gauge),angular.extend(n.knob.minutes.options,i.style.minutes.gauge),angular.extend(n.knob.seconds.options,i.style.seconds.gauge)
var r,g,u,C,d,c=!1
if("string"==typeof n.date&&n.date.length>0){var h=moment(),y=moment(n.date,"YYYY-MM-DD HH:mm Z")
d=y.diff(h,"seconds")}else d=parseInt(n.time)
n.secondsToDHMS=function(){r=Math.floor(d/86400),g=Math.floor(d%86400/3600),u=Math.floor(d%86400%3600/60),C=Math.floor(d%86400%3600%60%60)},n.doTick=function(){d--,n.secondsToDHMS(),d<=0&&(c||(c=!0,n.$eval(n.finishCallback),o.cancel(this.timerInterval)),r=0,g=0,u=0,C=0),l.find(".ClassyCountdown-days input").val(r).change(),l.find(".ClassyCountdown-hours input").val(g).change(),l.find(".ClassyCountdown-minutes input").val(u).change(),l.find(".ClassyCountdown-seconds input").val(C).change(),l.find(".ClassyCountdown-days .ClassyCountdown-value > div").html(r),l.find(".ClassyCountdown-hours .ClassyCountdown-value > div").html(g),l.find(".ClassyCountdown-minutes .ClassyCountdown-value > div").html(u),l.find(".ClassyCountdown-seconds .ClassyCountdown-value > div").html(C)},n.$on("timer-start",function(){n.doTick()}),n.$on("timer-pause",function(){n.resume()}),n.$on("timer-resume",function(){n.resume()}),n.$on("timer-stop",function(){n.stop()}),n.$on("timer-add-seconds",function(o,t){n.addSeconds(t.seconds)}),n.$on("timer-set-seconds",function(o,t){n.setSeconds(t.seconds)}),n.init=function(){n.secondsToDHMS(),l.find(".ClassyCountdown-wrapper > div").attr("style",settings.style.element),l.find(".ClassyCountdown-days .ClassyCountdown-value").attr("style",settings.style.days.textCSS),l.find(".ClassyCountdown-hours .ClassyCountdown-value").attr("style",settings.style.hours.textCSS),l.find(".ClassyCountdown-minutes .ClassyCountdown-value").attr("style",settings.style.minutes.textCSS),l.find(".ClassyCountdown-seconds .ClassyCountdown-value").attr("style",settings.style.seconds.textCSS),l.find(".ClassyCountdown-value").each(function(){$(this).css("margin-top",Math.floor(0-parseInt($(this).height())/2)+"px")}),settings.labels&&(l.find(".ClassyCountdown-days .ClassyCountdown-value > span").html(settings.labelsOptions.lang.days),l.find(".ClassyCountdown-hours .ClassyCountdown-value > span").html(settings.labelsOptions.lang.hours),l.find(".ClassyCountdown-minutes .ClassyCountdown-value > span").html(settings.labelsOptions.lang.minutes),l.find(".ClassyCountdown-seconds .ClassyCountdown-value > span").html(settings.labelsOptions.lang.seconds),l.find(".ClassyCountdown-value > span").attr("style",settings.labelsOptions.style)),l.find(".ClassyCountdown-days .ClassyCountdown-value > div").html(r),l.find(".ClassyCountdown-hours .ClassyCountdown-value > div").html(g),l.find(".ClassyCountdown-minutes .ClassyCountdown-value > div").html(u),l.find(".ClassyCountdown-seconds .ClassyCountdown-value > div").html(C),l.find(".ClassyCountdown-days input").val(r).change(),l.find(".ClassyCountdown-hours input").val(g).change(),l.find(".ClassyCountdown-minutes input").val(u).change(),l.find(".ClassyCountdown-seconds input").val(C).change(),l.find(".ClassyCountdown-days input").val(r).knob(angular.extend(n.knob.days.options,{width:$(".ClassyCountdown-days").width()})),l.find(".ClassyCountdown-hours input").val(g).knob(angular.extend(n.knob.hours.options,{width:$(".ClassyCountdown-hours").width()})),l.find(".ClassyCountdown-minutes input").val(u).knob(angular.extend(n.knob.minutes.options,{width:$(".ClassyCountdown-minutes").width()})),l.find(".ClassyCountdown-seconds input").val(C).knob(angular.extend(n.knob.seconds.options,{width:$(".ClassyCountdown-seconds").width()}))},n.start=function(){this.timerInterval=o(function(){n.doTick()},1e3)},n.pause=function(){o.cancel(this.timerInterval)},n.resume=function(){n.start()},n.stop=function(){d=0,n.secondsToDHMS(),l.find(".ClassyCountdown-days .ClassyCountdown-value > div").html(r),l.find(".ClassyCountdown-hours .ClassyCountdown-value > div").html(g),l.find(".ClassyCountdown-minutes .ClassyCountdown-value > div").html(u),l.find(".ClassyCountdown-seconds .ClassyCountdown-value > div").html(C),l.find(".ClassyCountdown-hours input").val(g).change(),l.find(".ClassyCountdown-minutes input").val(u).change(),l.find(".ClassyCountdown-seconds input").val(C).change()},n.addSeconds=function(n){d+=n},n.setSeconds=function(n){d=n},n.init(),function(){l.find(".ClassyCountdown-wrapper > div").each(function(){$(this).css("height",$(this).width()+"px")}),settings.style.textResponsive&&(l.find(".ClassyCountdown-value").css("font-size",Math.floor(l.find("> div").eq(0).width()*settings.style.textResponsive/10)+"px"),l.find(".ClassyCountdown-value").each(function(){$(this).css("margin-top",Math.floor(0-parseInt($(this).height())/2)+"px")})),$(window).trigger("resize"),$(window).resize($.throttle(50,a))}(),"true"==s.autostart&&n.start()}]}}])
